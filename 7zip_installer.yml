---

- name: 7zip installer

  hosts: win

  tasks:

    - name: Download the 7zip installer

      win_get_url:

        url: https://www.7-zip.org/a/7z1701-x64.msi

        dest: C:\ansible_examples\7z1701-x64.msi


    - name: Install MSI

      win_package:

        path: C:\ansible_examples\7z1701-x64.msi
        
    - name: Clean up installer
      win_file:
       path: C:\ansible_examples\7z1701-x64.msi
       state: absent
~                                                                      